<!DOCTYPE html>
<html class="light" lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Sim-Sang Guided Daily Reflection</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700&amp;display=swap"
    rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "warm-gray": {
              50: "#f9f9f8",
              100: "#f2f2ef",
              200: "#e5e5e0",
              300: "#d2d2cb",
              400: "#b9b9b1",
              500: "#a0a096",
              600: "#85857a",
            },
            "pale-blue": {
              50: "#f4f7fa",
              100: "#e9eff5",
              200: "#d2dfea",
              300: "#adbed4",
            },
            "elegant-gold": "#c5a059",
          },
          fontFamily: {
            "display": ["Inter", "sans-serif"]
          },
        },
      },
    }
  </script>
  <style>
    body {
      opacity: 0;
      transition: opacity 0.4s ease-in-out;
    }
  </style>
  <style type="text/tailwindcss">
    @layer base {
            body {
                @apply bg-warm-gray-50 text-warm-gray-600 font-display;
            }
        }
        ::-webkit-scrollbar {
            width: 4px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #d2d2cb;
            border-radius: 10px;
        }
        .gold-glow {
            box-shadow: 0 0 15px rgba(197, 160, 89, 0.15);
        }
        .divider-line {
            height: 1px;
            background: linear-gradient(to right, transparent, #e5e5e0, transparent);
        }
        .date-picker-hidden {
            opacity: 0;
            position: absolute;
            z-index: -1;
        }
    </style>
</head>

<body class="flex flex-col min-h-screen">
  <!-- Header -->
  <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-warm-gray-200">
    <div class="max-w-screen-md mx-auto px-4 h-16 md:px-6 md:h-20 flex items-center justify-between">
      <div class="flex items-center gap-4 relative">
        <div onclick="toggleDatePicker()" class="flex flex-col cursor-pointer group">
          <span
            class="text-sm uppercase tracking-wide text-elegant-gold font-bold group-hover:text-warm-gray-600 transition-colors">Select
            Date</span>
        </div>
        <button id="btnToday"
          class="text-[10px] font-bold text-warm-gray-700 hover:text-elegant-gold uppercase tracking-widest border border-warm-gray-200 rounded px-2 py-1 ml-2 transition-colors">Today</button>
        <input type="text" id="dateInput" readonly
          class="border border-warm-gray-300 rounded-md p-2 text-base bg-transparent focus:outline-none focus:ring-1 focus:ring-elegant-gold/50 focus:border-elegant-gold uppercase text-warm-gray-700 w-32 md:w-28 text-center">

        <!-- Custom Date Picker Dropdown -->
        <div id="customDatePicker"
          class="absolute top-14 left-0 z-50 hidden bg-white/90 backdrop-blur-md border border-elegant-gold/30 shadow-xl rounded-xl p-4 w-64 animate-in fade-in zoom-in-95 duration-200">
          <div class="flex justify-between items-center mb-4">
            <button onclick="changeMonth(-1)" class="text-warm-gray-700 hover:text-elegant-gold transition-colors">
              <span class="material-icons text-sm">chevron_left</span>
            </button>
            <span id="pickerMonthYear" class="text-sm font-bold text-warm-gray-600 uppercase tracking-widest"></span>
            <button onclick="changeMonth(1)" class="text-warm-gray-700 hover:text-elegant-gold transition-colors">
              <span class="material-icons text-sm">chevron_right</span>
            </button>
          </div>
          <div class="grid grid-cols-7 text-center mb-2">
            <span class="text-[10px] text-warm-gray-700 font-bold">S</span>
            <span class="text-[10px] text-warm-gray-700 font-bold">M</span>
            <span class="text-[10px] text-warm-gray-700 font-bold">T</span>
            <span class="text-[10px] text-warm-gray-700 font-bold">W</span>
            <span class="text-[10px] text-warm-gray-700 font-bold">T</span>
            <span class="text-[10px] text-warm-gray-700 font-bold">F</span>
            <span class="text-[10px] text-warm-gray-700 font-bold">S</span>
          </div>
          <div id="pickerGrid" class="grid grid-cols-7 gap-1 text-center text-xs">
            <!-- Days generated by JS -->
          </div>
        </div>
      </div>

      <div class="hidden md:flex items-center gap-2 pl-4 border-l border-warm-gray-200">
        <div class="text-right">
          <!-- Moved Date Display Here -->
          <h2 id="dateDisplay" class="text-xs font-bold text-elegant-gold uppercase tracking-widest">Loading...</h2>
          <p id="dateDisplaySub" class="text-[10px] text-warm-gray-700">Loading...</p>
        </div>
      </div>
    </div>
  </header>

  <main class="flex-1 max-w-screen-md mx-auto w-full px-4 py-8 space-y-16 md:px-6 md:py-12 md:space-y-24">
    <!-- Hero Section: Hexagram (Gua) Info Moved Here -->
    <section class="text-center space-y-2 relative">
      <!-- Hexagram Display -->
      <h3 id="guaHeader" class="text-2xl md:text-3xl font-light text-warm-gray-600 transition-colors">-</h3>
      <p id="guaMeta" class="text-sm tracking-[0.2em] uppercase text-warm-gray-400 leading-relaxed italic">-</p>

      <div class="pt-8 flex justify-center">
        <span class="material-symbols-outlined text-elegant-gold text-3xl font-extralight">expand_more</span>
      </div>
    </section>

    <!-- Hexagram Sigil & Detailed Text Section -->
    <section class="space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-1000">
      <div class="flex flex-col items-center text-center">
        <!-- Sigil Image Container -->
        <div id="sigil"
          class="mb-6 md:mb-8 p-4 bg-white rounded-2xl gold-glow flex justify-center items-center min-w-[170px] min-h-[170px]">
          <!-- Image will be injected here by logic.js -->
        </div>

        <div class="space-y-4 max-w-lg">
          <!-- Detailed Hexagram Display (Moved Here) -->
          <h3 id="yaoTitle" class="text-xl font-light text-warm-gray-600 transition-colors">-</h3>
          <p id="yaoShort" class="text-sm tracking-[0.05em] text-warm-gray-700 leading-relaxed italic px-4">-</p>
        </div>
      </div>
      <div class="divider-line my-12"></div>
    </section>

    <!-- Daily Emanations (Yao) -->
    <section class="space-y-12">
      <div class="flex items-center justify-center gap-3">
        <span class="material-symbols-outlined text-pale-blue-300">psychology</span>
        <h4 class="text-xs font-bold uppercase tracking-[0.3em] text-warm-gray-400">Daily Emanations</h4>
        <span class="material-symbols-outlined text-pale-blue-300">psychology</span>
      </div>

      <!-- Merged Content Box -->
      <div class="space-y-4 bg-white/40 p-6 md:p-8 rounded-2xl border border-pale-blue-100 h-full">
        <!-- Summary removed as requested -->
        <!-- <h5 class="text-xs font-bold uppercase text-elegant-gold tracking-widest">Detailed Context</h5> -->

        <!-- We can display yaoShort and yaoBody together or just yaoBody. 
             User asked to merge "Summary" and "Detail". 
             I will keep yaoBody as the main content. 
             If yaoShort is needed, it can be appended, but user said "remove Summary". -->
        <p class="hidden">-</p>
        <p id="yaoBody" class="text-warm-gray-700 leading-relaxed whitespace-pre-wrap text-left">
          -
        </p>
      </div>

      <div class="divider-line my-12"></div>
    </section>

    <!-- Calendar of the Soul -->
    <section class="space-y-8">
      <div class="flex flex-col items-center text-center space-y-6">
        <!-- Week Badge -->
        <div id="soulBadge"
          class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-elegant-gold/10 text-elegant-gold text-[10px] font-bold tracking-widest uppercase">
          -
        </div>
        <!-- Title -->
        <h4 class="text-xl font-light text-warm-gray-600 flex items-center gap-3">
          <span class="material-icons text-elegant-gold/40">local_florist</span>
          Calendar of the Soul
          <span class="material-icons text-elegant-gold/40">local_florist</span>
        </h4>

        <!-- Soul Content Card -->
        <div class="w-full max-w-xl relative group rounded-3xl overflow-hidden shadow-sm border border-warm-gray-200">
          <div class="absolute inset-0 opacity-10 grayscale hover:grayscale-0 transition-all duration-700"
            style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDXS8rO2euP90iNFxqWuR6Mcjtwcgtx13qBOuBJ-MuEKboNhqdR1wMHH42CL1JTIb62NeaZHMrbrM-qcY2yxMUajOixJicwZM2lsayY4NYIHCVvqSa1nU13H4Iz_2dLGLjPEfHYywtM3UYULGLVwJEepbyvvLclJvaxCeF2ZuInfC0B7lpb1fey0QCENUwpcqZfN3cCLvXBY2_noqcL-zs_eRqxxV8-CD21PbeDngX7WKcpAUv3w7vkiCue1bRDVqGMoq_B-SrJJB5O'); background-size: cover; background-position: center;">
          </div>
          <div class="relative z-10 bg-white/90 p-6 md:p-16">
            <!-- Verse Text -->
            <div id="soulBody"
              class="font-display italic text-xl md:text-2xl leading-loose text-warm-gray-600 whitespace-pre-wrap">
              -
            </div>
            <div class="mt-8 pt-8 border-t border-warm-gray-100 flex justify-center">
              <span class="text-[10px] text-warm-gray-400 uppercase tracking-[0.4em]">Rudolf Steiner</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="flex flex-col items-center pt-8 pb-20">
      <button onclick="openJournal()"
        class="px-8 py-4 bg-white border border-elegant-gold text-elegant-gold hover:bg-elegant-gold hover:text-white rounded-full text-sm font-medium tracking-widest uppercase transition-all flex items-center gap-3 gold-glow">
        <span class="material-icons text-base">edit_note</span>
        Add Journal Entry
      </button>
      <div class="mt-12 flex items-center gap-3 opacity-30">
        <div class="w-1.5 h-1.5 rounded-full bg-elegant-gold"></div>
        <div class="w-1.5 h-1.5 rounded-full bg-elegant-gold"></div>
        <div class="w-1.5 h-1.5 rounded-full bg-elegant-gold"></div>
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-warm-gray-100 py-5 md:py-10 border-t border-warm-gray-200">
    <div class="max-w-screen-md mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-6">
      <div class="flex items-center gap-4">
        <div class="flex items-center justify-center text-elegant-gold/70">
          <span class="material-symbols-outlined text-2xl font-light">self_improvement</span>
        </div>
        <h1 class="text-xl font-extralight tracking-[0.1em] text-warm-gray-600 leading-none">
          Sim-Sang <span class="text-elegant-gold font-light">Calendar</span>
        </h1>
      </div>
      <div class="hidden sm:flex items-center gap-4">
        <div class="text-right">
          <div class="text-xs text-warm-gray-700">Contact</div>
          <div class="text-sm font-medium text-warm-gray-600">roadsea@naver.com</div>
        </div>
        <div
          class="hidden md:flex w-10 h-10 rounded-full border border-elegant-gold/20 items-center justify-center text-elegant-gold/50">
          <span class="material-icons text-xl">mail_outline</span>
        </div>
      </div>
    </div>
  </footer>

  <!-- Journal Modal (Hidden by default) -->
  <div id="journalModal" class="fixed inset-0 z-[60] hidden">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-warm-gray-600/30 backdrop-blur-sm transition-opacity" onclick="closeJournal()">
    </div>

    <!-- Modal Content -->
    <div
      class="absolute inset-x-4 top-[5%] md:top-[15%] max-w-2xl mx-auto bg-white rounded-3xl shadow-2xl p-6 md:p-10 border border-warm-gray-100 flex flex-col gap-6 animate-in slide-in-from-bottom-4 duration-300">

      <!-- Header -->
      <div class="flex items-start justify-between">
        <div>
          <h3 class="text-xl font-display font-light text-warm-gray-600">오늘의 명상 기록</h3>
          <p id="journalDate" class="text-xs font-bold uppercase tracking-widest text-elegant-gold mt-1">Downloading...
          </p>
        </div>
        <button onclick="closeJournal()" class="text-warm-gray-400 hover:text-warm-gray-600 transition-colors">
          <span class="material-icons">close</span>
        </button>
      </div>

      <!-- Guided Question -->
      <div class="bg-warm-gray-50/50 p-4 rounded-xl border border-warm-gray-100">
        <p id="journalQuestion" class="text-sm text-warm-gray-500 italic leading-relaxed">
          Loading reflection question...
        </p>
      </div>

      <!-- Text Area -->
      <textarea id="journalEntry"
        class="w-full h-64 p-4 bg-transparent border border-warm-gray-200 rounded-xl focus:border-elegant-gold focus:ring-1 focus:ring-elegant-gold resize-none font-display text-warm-gray-600 placeholder:text-warm-gray-300 leading-relaxed"
        placeholder="여기에 생각과 느낌을 자유롭게 기록해보세요..."></textarea>

      <!-- Footer Actions -->
      <div class="flex flex-col-reverse md:flex-row items-center justify-between pt-2 gap-4">
        <div class="flex gap-4 w-full md:w-auto justify-center">
          <button onclick="downloadJournalToday()"
            class="text-xs font-bold uppercase tracking-widest text-warm-gray-400 hover:text-elegant-gold transition-colors flex items-center gap-2">
            <span class="material-icons text-sm">download</span>
            오늘 기록
          </button>
          <button onclick="downloadJournalAll()"
            class="text-xs font-bold uppercase tracking-widest text-warm-gray-400 hover:text-elegant-gold transition-colors flex items-center gap-2">
            <span class="material-icons text-sm">folder_zip</span>
            전체 기록
          </button>
        </div>
        <div class="flex gap-3 w-full md:w-auto">
          <button onclick="closeJournal()"
            class="flex-1 md:flex-none px-6 py-2.5 rounded-full text-sm font-medium text-warm-gray-500 hover:bg-warm-gray-50 transition-colors">
            취소
          </button>
          <button onclick="saveJournal()"
            class="flex-1 md:flex-none px-8 py-2.5 bg-elegant-gold text-white rounded-full text-sm font-medium shadow-lg shadow-elegant-gold/20 hover:shadow-xl hover:-translate-y-0.5 transition-all">
            저장하기
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="fixed top-6 left-1/2 -translate-x-1/2 z-[70] hidden opacity-0 transition-opacity duration-500">
    <div
      class="bg-white/90 backdrop-blur-md border border-elegant-gold/30 shadow-xl shadow-elegant-gold/10 px-8 py-4 rounded-full flex items-center gap-3">
      <span class="material-icons text-elegant-gold text-xl">check_circle</span>
      <span id="toastMessage" class="text-sm font-medium text-warm-gray-600 tracking-wide">저장되었습니다</span>
    </div>
  </div>

  <!-- Error container -->
  <div id="err"
    class="fixed bottom-0 left-0 right-0 bg-red-600/90 text-white p-4 text-center z-[100] hidden empty:hidden">
  </div>

  <!-- Scripts -->
  <script src="data.js"></script>
  <script src="logic.js" defer></script>
</body>

</html>